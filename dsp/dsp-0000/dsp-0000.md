<pre>
  DSP: 0000
  Title: NFT Visualization
  Author: Agustin Mendez <agus@decentraland.org>
  Status: Draft
  Type: Standards
  Created: 2019-04-15
</pre>

# NFT Visualization in Decentraland

## Introduction

...

## Abstract

This document describes the capabilities and high level architecture of the parts involved in visualization of NFTs inside Decentraland.

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC 8174](https://tools.ietf.org/html/rfc8174) when, and only when, they appear in all capitals, as shown here.

# Terminology

**NFT**:  
 Non-Fungible Token. It is an instance inside the registry.

**Registry**:  
 The source of thruth of the NFTs. May be a contract, or an API.

**Picture frame**:  
 Some NFT are just images, without a 3D representation, a picture frame is the 3D fallback for images, in the shape of a real picture frame.

**Schema API**:  
 The API acting as a facade on top of the Registry. The validations and data-fetch are executed against this API. It follows the [NFT Schema API]().

**Registry/NFT URI**:
The registry identifier is the URI that identifies the Registry and Schema API. The format of the URI is defined as:

**Shape component**:
Inside Decentraland's ECS, entities in the world may contain components, among other things, the components define the visual aspects of the entity. A shape component defines how an entity looks inside the world.

```
Format:
  [blockchain/protocol]://[unique registry id]/[asset id]
Examples:
  # Decentraland LAND Registry, ethereum blockchain
  ethereum://0xf87e31492faf9a91b02ee0deaad50d51d56d5d4d

  # Crypto Kitties Registry, ethereum blockchain
  ethereum://0x06012c8cf97bead5deae237070f9587f8e7a266d

  # Another blockchain's registry
  other-blockchain://contract-id

  # Specific Decentraland's LAND
  ethereum://0xf87e31492faf9a91b02ee0deaad50d51d56d5d4d/20076659648335369344339101838474324475768

  # Another blockchain's NFT
  other-blockchain://contract-id/nft-id-00000000
```

# Implementation

## Source of truth

It is required a **Schema API** to validate the ownership of the NFT, that API must follow the [NFT Schema API](#link). A brief summary of the API is that it answers to the following queries:

- What are the NFTs of a given address?
- What is the description of a given NFT?
- Who is the owner of a given NFT?

## Validation of ownership

The algorithm to validate ownership of an NFT has two variants. For each variant, the NFT is valid if one of the rules is true.

1. An NFT is inside a parcel.  
   a. If `parcel.owner` == `NFT.owner`  
   b. If `parcel.operator` == `NFT.owner`  
   c. If `parcel.parentEstate.owner` == `NFT.owner`  
   d. If `parcel.parentEstate.operator` == `NFT.owner`  
   e. If `NFT.traits['dcl-isPublicDomain']` == `true`

2. An NFT has to be shown in a wallet / inventory  
   a. If `wallet.owner` == `NFT.owner`  
   b. If `NFT.traits['dcl-isPublicDomain']` == `true`

## Validation of registries

The registries must be part of a curated index. That index must be exposed as a HTTP API and it must map the **Registry URI** to a **Schema API**.

## Visualize inside the world

Any NFT may be represented as a 3D model or picture frame but that is also possible with the SDK and raw assets without needing the ownership of the NFT. The NFTs need to be shown in some unique and distinctive way, it must be different to anything the user can create in Decentraland to avoid copies and thus make it loose its value. To do so, we will show a distinctive badge on top of the NFT (in-world).

## Visualize in a wallet / inventory

The visualization in wallets uses the 3D model when available and possible, otherwise it uses the thumbnails as a fallback.

## Usage inside Decentraland scenes

The Decentraland ECS exposes a **Shape component** to be attached to the entities called `NFTShape(uri: string)`. It will receive the full **Registry URI** of the **NFT**.

Example:

```ts
const myCatContainer = new Entity();
const myCat = new NFTShape("ethereum://0x06012c8cf97bead5deae237070f9587f8e7a266d/508394");

myCat.addComponent(myCat);
```

Will show an entity corresponding to this NFT: https://etherscan.io/token/0x06012c8cf97bead5deae237070f9587f8e7a266d?a=508394#inventory
